<%= render "workout_builder_header" %>

<div id="workout-builder-app" class="builder autoheight">

    <div class="column split-left">
        <div class="column-wrap autoheight">
            <%= render "library_moves_panel" %>
            <%= render "move_details_panel" %>
        </div>
    </div>

    <div class="column split-right">
        <div id="workout-editor" class="column-wrap autoheight">
            <div class="workout-blocks" id="catalog">
                <ul class="block-option-ul new_block">
                    <% Block::BLOCK_TYPE.each_with_index do |block, index| %>
                        <% if index < 3 %>
                            <li id="dragable_block_<%=index%>" class="block" data-dragable-type="block" data-block-name="<%=Block::BLOCK_TYPE[index]%>">
                                <%= block.humanize %>
                            </li>
                        <% end %>
                    <% end %>
                </ul>
                <%= render "block_templates" %>
            </div>

            <div class="workout-preview" id="cart">
                <%=form_tag("/builder/save_blocks", method: "post", id: "new_workout_form") do |bl|%>

                    <%=hidden_field_tag :workout_id %>
                    <ul class="workout-list builder-dropzone add_photo drag_lib testt" data-block="main">
                        <%= render "sub_blocks" %>
                    </ul>

                    <div class="hidden_field_workout"></div>
                <% end %>
            </div>
        </div>
    </div>

</div>

<script type="text/javascript">
$(document).ready(function(){

    $("#cart .testt").sortable({
        placeholder: 'sortable-placeholder',
        update: function() {
            block_sortable();
        }
    }).disableSelection();

    initDroppable();

    $("#catalog ul li").draggable({
        connectToSortable:'#cart ul li',
        cursor: 'grabbing',
        zIndex: 9999,
        appendTo: 'body',
        containment: '#workout-editor',
        helper: function() {
            return $("<div class='dragging-block-wrap'></div>").append($(this).clone());
        }
    });

    $("#move ul li").draggable({
        connectToSortable:'#cart ul li',
        cursor: 'grabbing',
        zIndex: 9999,
        scroll : false,
        appendTo: 'body',
        containment: '#workout-builder-app',
        //handle: '.handle',
        //placeholder: 'sortable-placeholder',
        helper: function() {
            return $("<div class='dragging-move-wrap'></div>").append($(this).clone());
        }
    });
    flag = true;
})

</script>


<%= render :partial => "workouts/builderscripts/builder_drag_drop" %>
<%= render :partial => "workouts/builderscripts/calculate_builder_dimensions" %>

<%= form_tag('/library/crop_image_save', remote: true, id: 'crop_image_form') do |crop| %>
    <img src="<%=current_user.pic.url(:display)%>" class="cropper">
  <%["x", "y", "width", "height"].each do |att|%>
    <%=hidden_field_tag "#{att}"%>
  <%end%>
  <%=hidden_field_tag "type", params[:type]%>
  <%=hidden_field_tag "id", params[:id]%>
  <%=button_tag :button%>
<%end%>

<script>

var $image = $('.cropper'),
    $dataX = $("#x"),
    $dataY = $("#y"),
    $dataHeight = $("#height"),
    $dataWidth = $("#width");

$image.cropper({
  aspectRatio: "auto",
  multiple: true,
  data: {
    x: 200,
    y: 200,
    width: 400,
    height: 200
  },
  done: function(data) {
    $dataX.val(data.x);
    $dataY.val(data.y);
    $dataHeight.val(data.height);
    $dataWidth.val(data.width);
  }
})
</script>